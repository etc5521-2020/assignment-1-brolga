---
title: "ETC5521 Assignment 1"
subtitle: "Your title"
team: brolga
author:
  - Dilinie Seimon
  - Diyao Chen
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2
---

```{r setup, echo = FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.align = "center")
library(tidyverse)
library(readr)
library(kableExtra)
library(visdat)
library(tidytext)
library(wordcloud)
set.seed(5521.2020)
```

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r retreiving-and-saving-data-files, eval=FALSE}
write_csv(readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/critic.tsv'), "Data/critics.csv")
write_csv(readr::read_tsv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/user_reviews.tsv'), "Data/user-reviews.csv") 
write_csv(readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/items.csv'), "Data/items.csv")
write_csv(readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/villagers.csv'), "Data/villagers.csv")
```

```{r reading-in-data}
critics <- read_csv("Data/critics.csv")
user_reviews <- read_csv("Data/user-reviews.csv")
items <- read_csv("Data/items.csv")
villagers <- read_csv("Data/villagers.csv")
```


# Introduction and motivation

[`r knitr::include_graphics("Images/animal-crossing-new-horizons.jpg")`]{style="align:right;"}

Animal Crossing: New Horizons is a life simulation video game developed and published by Nintendo for the Nintendo Switch. It was released worldwide on the 20th of March 2020. Since it's inception the game has had an astounding world-wide reception With over 22 million copies of the game being sold in just 5 months.

In the animal crossing world a player takes the role of a customized human character who moves to a deserted island and carries out various activities such as gathering and crafting items, fishing and bug hunting in a village inhabited by various species of animals. Each of these animals called villagers in the animal crossing world, have their own name, gender, birthday, personality, favourite song and their own catchprhase. The items used in performing different tasks in the animal crossing belong to different categories and are also priced at different buying and selling values.

The game also simulates day and night based on a 24 hour clock, and has different animals and insects appearing at specific times of day or night. The level of detail in the design of the Animal Crossing world has attracted many users playing throughout the day.

Although it has been 5 only months since the game was released worldwide, it has been gaining alot of attention from both players and critics. Even non-players may find the concept of this game well designed and interesting.

The motivation for choosing Animal Crossing for the analysis is to attempt to understand the reason for the immense popularity of the game using user and critic reviews and features within the game (such as the villagers and the items).

Therefore, the analysis of the Animal Crossing: New Horizons game is subdivided into two broad areas and answers the following sub-questions.

**An analysis of the villagers and items used in the Animal Crossing world**  

* What are the most common species of animals(villagers) in the Animal Crossing world?  
* What are the personality types of the villagers?  
* What are the most common star signs of the villagers based on their birthdates?  
* What are the different categories of items available in the Animal Crossing world?  
* What are the cheapest and most expensive items available?
* How can players maximize their profits by buying and re-selling items?

**What are players and critics saying about Animal Crossing?**


* What is the trend of user and critic reviews on the Animal Crossing game?  
* What are the most common words users and critics use to describe Animal Crossing?  
* What are the sentiments and emotions portrayed by the users and critics reviews?  


# Data description

The dataset used for this analysis was retreived from [TidyTuesday](https://github.com/rfordatascience/tidytuesday); a project aimed at allowing individuals to practice their data wrangling and visualization skills through the use of real-world data sets.

The retreived dataset consisted of four sub-datasets; 'villagers' and 'items' datasets containing data about in-game characters and items, and 'user reviews' and 'critic reviews' datasets contatining data about user and critics reviews on the game.

The 'villagers' and 'items' datasets have been originally retreived from [VillagerDB](https://github.com/jefflomacy/villagerdb), which is a project aimed at making data about Animal Crossing available and easily accessible, while the user and critic reviews have been originally retreived by scraping the [Metacritic](https://www.metacritic.com/game/switch/animal-crossing-new-horizons/critic-reviews) website.

### Data dictionary

```{r}
data_dict <- function(df, desc = c()){
  return(data.frame(
    "Variable" = names(df),
    "Description" = desc, 
    check.names = FALSE, row.names = NULL
  ) %>%
    kable() %>%
    kable_styling(bootstrap_options = c("striped")))
}
```
**Villagers**

The 'Villagers' dataset consists of data related to the characters in the Animal Crossing game world. The following are the variables in the villagers dataset and their descriptions.

```{r}
data_dict(villagers, c("Numeric identifier of villager", "Short text identifier of villager", "Name of villager", "Gender of villager", "Species of villager", "Birthday of villager", "Personality of Villager", "Song associated with villager", "Catchphrase of the villager", "Full text identifier of villager", "Link to image of villager"))
```

**Items**

The 'Items' dataset consists of data related to the items in the Animal Crossing game world. The following are the variables in the items dataset and their descriptions.

```{r}
data_dict(items, c("Numeric identifier of item", "Character identifier of villager", "Name of item", "Category of item", "Orderable from catalog", "Selling value", "Selling currency", "Buying value", "Buying currency", "Way/place to acquire item", "Is item customizable", "Recipe number", "Recipe ID", "Game ID", "Full Character ID", "Link to image of item"))
```

**User Reviews**

The 'User Reviews' dataset consists of the scores and reviews made by users from `r min(user_reviews$date)` to `r max(user_reviews$date)`.

```{r}
data_dict(user_reviews, c("Raw score(0-10) given, 0-lowest and 10-highest","User name of the reviewer","Raw text of the review","Date the review was published"))
```

**Critic Reviews**

The 'Critic Reviews' dataset consists of the scores and reviews made by critics about the game from `r min(critics$date)` to `r max(critics$date)`.

```{r}
data_dict(critics, c("Raw score(0-100) given, 0-lowest and 100-highest","The source of the reviewer","Raw text of the review","Date the review was published"))
```

# Data Exploration and Wrangling


## Handling Missing Values

```{r}
vis_miss(items)
```

The columns with over 80% missing values were dropped from the analysis due to the inabiility to impute values accurately.

## Currency conversion

The buying and selling currencies of items in the animal crossing world were expressed in two currencies; Bells and Miles. For simplification of the analysis all buying and selling prices were converted into Bells.

[The Nintendo guides](https://www.nintendolife.com/guides/animal-crossing-new-horizons-bells-how-to-make-bells-fast-nook-miles-and-money-explained#exchange-a-bell-voucher-500-nook-miles-for-3000-bells) states that a Bell Voucher can be bought for 500 Nook Miles, which can thereafter be exchanged for 3000 Bells in the Animal Crossing world . Therefore it was assumed that each Mile equated to 6 Miles in the currency convesion.

```{r currency-conversion}
items <- items %>%
  mutate(buy_value = case_when(
    buy_currency == "miles" ~ buy_value*6,
    TRUE ~ buy_value
  )) %>%
  mutate(buy_currency = case_when(
    buy_currency == "miles" ~ "bells",
    TRUE ~ buy_currency
  )) %>%
  mutate(sell_value = case_when(
    sell_currency == "miles" ~ sell_value*6,
    TRUE ~ sell_value
  )) %>%
  mutate(sell_currency = case_when(
    sell_currency == "miles" ~ "bells",
    TRUE ~ sell_currency
  ))
```

# Analysis and findings

[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings.

## An analysis of the villagers in the Animal Crossing World


The villagers in Animal Crossing are of different species and also have their own gender, birthdate, personality, favourite song and unique catch phrase.

Figure \@ref(fig:count-species-villagers) is a plot of the villagers in the Animal Crossing world belonging to each species and gender category.

```{r count-species-villagers, fig.cap="The number of villagers belonging to each species"}
villagers %>%
  ggplot(aes(x = fct_infreq(species),
             fill = gender)) +
  geom_bar() +
  coord_flip() +
  labs(y = "Number of Villagers",
       x = "Species")
```

As visualised in Figure \@ref(fig:count-species-villagers), there are `r nrow(villagers)` villagers belonging to `r length(unique(villagers$species))` different species in the Animal Crossing world. Cats, rabbits, frogs and squirrels are among the most common species, while bulls, rhinos, cows and octupuses are relatively uncommon. Another interesting observation can be seen in the breakdown of each species by gender. Most species have villagers belonging to both male and female categories, but all bulls and lions are male while all cows are female. This maybe due to the terms 'cow' and 'bull' being gender specific; cows being the female counterpart of bulls. This however does not explain the non-existence of female lions in the Animal Crossing world.




## An analysis of the Items in the Animal Crossing World

```{r item-categories}
items %>%
  ggplot(aes(x = fct_infreq(category))) +
  geom_bar(aes(fill = category)) +
  labs(title="Number of Items belonging to each category",
       x = "Item Category",
       y = "Number of Items") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
        legend.position = "none")
```

```{r price-distribution-over-categories, eval=FALSE}
items %>%
  group_by(category) %>%
  summarise(med_buy_price = mean(buy_value, na.rm = TRUE),
            med_sell_price = mean(sell_value, na.rm = TRUE)) %>%
  pivot_longer(cols = c("med_buy_price", "med_sell_price"),
               names_to = "measure",
               values_to = "value") %>%
  ggplot(aes(x = value, y = category)) +
  geom_point(aes(color = measure)) +
  scale_fill_manual(values=c("#F8766D", "#00BA38"))



  pivot_longer(cols = c(sell_value,buy_value),
               names_to = "type",
               values_to = "value") %>%
  ggplot(aes(x=category,
             y=value,
             color = category)) +
  geom_point() +
  facet_wrap(~ type, nrow = 1) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
        legend.position = "none")
  
items %>%
  filter(category == "Fossils" & !is.na(buy_value)) %>%
  select(buy_value)
```

Buying prices of Fish and Fossils were not available

```{r}
items %>%
  mutate("Profit" = sell_value - buy_value,
         "Selling Price" = paste0(sell_value," ",sell_currency),
         "Buying Price" = paste0(buy_value," ",buy_currency)) %>%
  filter(Profit > 0) %>%
  arrange(desc(Profit)) %>%
  rename("Name" = name,
         "Category" = category) %>%
  select(Name, Category, "Selling Price", "Buying Price", Profit) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

## What do the users say?


Figure \@ref(fig:user-review-trend) is a plot of the trend of user reviews on Metacritic from `r min(user_reviews$date)` - `r max(user_reviews$date)`.

```{r user-review-trend, fig.cap="Trend of user reviews"}
user_reviews %>%
  group_by(date) %>%
  summarise(count = n()) %>%
  ggplot(aes(x=date,
             y=count)) +
  geom_line() +
  scale_x_date(date_breaks = "1 week")
```

The astounding reception of Animal Crossing: New Horizons since its world release on the 20th of March 2020 is justified by the number of daily user reviews it has received. However Figure \@ref(fig:user-review-trend) shows a huge spike in the number of reviews on the 24th of March 2020, lasting till about the 26th of March 2020, which may be attributed to the world release of the game on the 20th of March 2020. The number of reviews there after remain consistent other than another smaller spike around the 28th of April 2020.

Figure \@ref(fig:user-review-wordcloud) shows the most common words in the user reviews for the game. The words 'game', 'island', 'switch' and 'play' are the most common words in the user reviews and doesn't show a direct positive or negative significance based on them.

```{r user-review-wordcloud, fig.cap="The most used words in the user reviews"}
user_review_words <- user_reviews %>%
  unnest_tokens(word, text) %>%
  anti_join(stop_words, by="word") 

user_review_word_freq <- user_review_words %>%
  group_by(word) %>%
  summarise(freq = n()) %>%
  arrange(desc(freq)) 

wordcloud(words = user_review_word_freq$word,
          freq = user_review_word_freq$freq,
          min.freq = 1,
          max.words=100,
          random.order=FALSE,
          rot.per=0.35, 
          colors=brewer.pal(8, "Dark2"))
```

The user reviews also includes a score from 0-10, where 0 is the lowest and 10 is the highest. Figure \@ref(fig:user-review-scores) is a plot of the disctribution of scores ranging from 0-10.

```{r user-review-scores, fig.cap="Distribution of user review scores on Animal Crossing: New Horizons"}
user_reviews %>%
  ggplot(aes(x=grade)) +
  geom_bar()
```

Most users score the game as a 0, while other users score the game as a 10. Almost all user scores are distributed to the two ends of the range of scores with very little reviews scroing the game a 5, 6 or 7. With the sudden hype about the game in the recent past, the low review scores seem questionable and may even thought of as the default score attached to a review if not explicitly stated. Therefore, it might be interesting to calculate the sentiments of the user reviews and relate them to their respective scores, to identify any correlation among them.

A sentiment score between -5 and +5 are given to each user review, where -5 indicates a highly negative sentiment and +5 indicates a highly positive sentiment.

Figure \@ref(fig:user-review-sentiments) is a boxplot summarizing the sentiment scores of all `r nrow(user_reviews)` from `r min(user_reviews$date)` - `r max(user_reviews$date)`.

```{r user-review-sentiments, fig.cap="Summary of sentiments of user-reviews"}
afinn <- get_sentiments("afinn")

user_review_sentiments <- user_review_words %>%
  inner_join(afinn, by = "word") %>%
  group_by(user_name, date, grade) %>%
  summarise(mean_sent = mean(value))

user_review_sentiments %>%
  ungroup() %>%
  ggplot(aes(x = mean_sent)) +
  geom_boxplot()
```

The boxplot in figure \@ref(fig:user-review-sentiments) states that the overall sentiment of the user reviews to be just slightly positive at 0.4, which is surprising as it would've been expected to be much higher with the recent popularity it has gotten. Most of the sentiments of the reviews also lie within a range of -1 to +1, which may indicate to us that Animal crossing isn't enjoyed by all and there are as many users dissatisfied by the game or disliking the game as those enjoying it.

The mean sentiment score of each review against its review score is plotted in figure \@ref(fig:user-review-score-vs-sentiment).

```{r user-review-score-vs-sentiment, fig.cap="Mean sentiment score of reviews against its review score"}
user_review_sentiments %>%
  ggplot(aes(x = mean_sent,
             y = grade)) +
  geom_point()
```

The distribution of points over the plot signifies no clear relationship among the sentiments of the review text and score.


## What do the critics say?

In the analysis of reviews made by critics, reviews published by `r nrow(critics)` critics such as Forbes, Telegraph and Nintendo Life from `r min(critics$date)` - `r max(critics$date)` are used.

```{r critic-review-trend, fig.cap="Trend of critic reviews"}
critics %>%
  group_by(date) %>%
  summarise(count = n()) %>%
  ggplot(aes(x=date,
             y=count)) +
  geom_line() +
  scale_x_date(date_breaks = "1 week")
```

Figure \@ref(fig:critic-review-trend) represents the trend in the number of critic reviews over time. Most critics have reviewed the game on the 16th of March, just before the world release of the game, while a smaller number of critics have made reviews in the days following that.

Since critics have the ability to influence people through their comments, it might be interesting to see the most used positive and negative words in their reviews.

```{r critic-positive-wordcloud, fig.cap="The most used positive words by the critics"}

bing <- get_sentiments("bing")

critic_words <- critics %>%
  unnest_tokens(word, text) %>%
  anti_join(stop_words, by="word") 

critic_word_freq <- critic_words %>%
  group_by(word) %>%
  summarise(freq = n()) %>%
  arrange(desc(freq)) %>%
  inner_join(bing, by = "word")

wordcloud(words = (critic_word_freq %>% filter(sentiment == "positive"))$word,
          freq = (critic_word_freq %>% filter(sentiment == "positive"))$freq,
          min.freq = 1,
          max.words=100,
          random.order=FALSE,
          rot.per=0.35, 
          colors=brewer.pal(8, "Dark2"))
```

```{r critic-negative-wordcloud, fig.cap="The most used negative words by the critics"}

wordcloud(words = (critic_word_freq %>% filter(sentiment == "negative"))$word,
          freq = (critic_word_freq %>% filter(sentiment == "negative"))$freq,
          min.freq = 1,
          max.words=100,
          random.order=FALSE,
          rot.per=0.35, 
          colors=brewer.pal(8, "Dark2"))
```

Figure \@ref(fig:critic-positive-wordcloud) shows the most used positive words in the critic reviews while figure \@ref(fig:critic-negative-wordcloud) shows the most negative words used. By direct observation of the two word clouds, the positivity seems to overpower the negativity in the critics reviews.

Figure \@ref(fig:critic-word-categories) is a further breakdown of the words used by critics in their reviews, based on eight basic emotions.

```{r critic-word-categories, fig.cap="Breakd down of words used by critics into different emotional categories"}
nrc <- get_sentiments("nrc")

critic_word_sent_category <- critic_words %>%
  group_by(word) %>%
  summarise(freq = n()) %>%
  arrange(desc(freq)) %>%
  inner_join(nrc, by = "word")

critic_word_sent_category %>%
  ggplot(aes(x = fct_infreq(sentiment))) +
  geom_bar() +
  coord_flip()
```

As per figure \@ref(fig:critic-word-categories), most wordsused in critics reviews are positive, and resonate the emotions of trust, anticipation and joy. A very few words used in reviews resonate the emotions of disgust, fear and anger, concluding an overall positive response from critics on the Animal Crossing game.


The scores given by the criitcs range from 0-100, 0 being the lowest and 100 being the highest. Figure \@ref(fig:critics-score-distribution) shows the disribution of these scores over critics reviews.

```{r critics-score-distribution, fig.cap="The distribution of critics scores on Animal Crossing- New Horizon"}
critics %>%
  ggplot(aes(x = grade)) +
  geom_bar()
```

It's interesting how all scores are above 70, while most of them are above 90. Comparing figure \@ref(fig:user-review-scores) and figure \@ref(fig:critics-score-distribution), the critics seem impressed with the game while the users have mixed reviews.


# References
